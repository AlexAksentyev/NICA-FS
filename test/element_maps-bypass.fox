INCLUDE 'bin/setups/BYPASS/SEQFULL_clean';


PROCEDURE RUN;
  VARIABLE RESTMASSAMU 1; VARIABLE GAMMA 1; VARIABLE GAMMA 1;
  VARIABLE WHERE 100;
  {for TREL}
  VARIABLE MAPPARAMS 1 6; {HOLDS THE ABOVE VALUES}
  VARIABLE MAPARR 1000 6 587; VARIABLE SPNRARR 1000 3 3 587;
  VARIABLE VRF 1 1 1;
  VARIABLE FREQ 1;
  VARIABLE HNUM 1;

  VARIABLE I 1;

  GAMMA := 1.129;

  DIRSET WHERE 'data/ELEMENT_MAPS/BYPASS/';
  
  OV 1 3 0; 
  SET_FOR_DEUTERONS GAMMA;

 LATTICE MAPPARAMS MAPARR SPNRARR;
  HNUM := 66;
  VRF(1, 1) := 100/HNUM; {RF Voltage [kV]}
  FREQ := HNUM*REVFREQ(fACCLEN(1)); {RF Frequency}
  UM; RF VRF 0 FREQ 0 0.05;
  { INSERT 1 MAPARR SPNRARR 546; }

    { OPENF 5315 WHERE&'ELEM_RF' 'REPLACE'; OPENF 5316 WHERE&'ELEM_RF-SPIN' 'REPLACE'; }
    {   UM;  RF VRF 0 FREQ 0 0.05; }
    {   WRITE 6 ' SYM ERROR = '&ST(SE(MAP)); }
    {   PM 5315; PSM 5316; }
    { CLOSEF 5315; CLOSEF 5316; }

  LOOP I 1 586;
    OPENF 5315 WHERE&'ELEM_'&MRK(I) 'REPLACE';OPENF 5316 WHERE&'ELEM_'&MRK(I)&'-SPIN' 'REPLACE';
      LMAPS I MAPARR SPNRARR;
      WRITE 6 'ELEMENT '&MRK(I)&' SYM ERROR = '&ST(SE(MAP));
      PM 5315;PSM 5316;
      { WRITE 5315 MAP(6); }
    CLOSEF 5315; CLOSEF 5316;
  ENDLOOP;
  
ENDPROCEDURE; {RUN}

RUN; END;
