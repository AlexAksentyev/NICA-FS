INCLUDE 'bin/setups/BENDS24SEQ_FULL';


PROCEDURE RUN;
  VARIABLE RESTMASSAMU 1; VARIABLE GAMMA 1; VARIABLE EKIN 1;
  VARIABLE WHERE 100;
  VARIABLE QF  1; VARIABLE QD  1;
  VARIABLE HZ1 1; VARIABLE HZ2 1;
  VARIABLE KZ1 1; VARIABLE KZ2 1;
  VARIABLE MAPPARAMS 1 6; {HOLDS THE ABOVE VALUES}
  VARIABLE MAPARR 1000 6 471; VARIABLE SPNRARR 1000 3 3 471;

  VARIABLE I 1;

  DIRSET WHERE 'data/ELEMENT_MAPS/SOL26/LEN_VARY/' 0;
  
  OV 1 3 0;
  SET_FOR_PROTONS HZ1 HZ2 QF QD;
  
  MAPPARAMS(1) := HZ1; MAPPARAMS(2) := HZ2;
  MAPPARAMS(3) := KZ1; MAPPARAMS(4) := KZ2;
  MAPPARAMS(5) := QF;  MAPPARAMS(6) := QD;

  IF TRUE;
  OPENF 5315 WHERE&'MAP_1' 'REPLACE';
    UM; { RBEND 1.9395014178063603 0.07853981633970679 0 ;  }{RBend_50}
      { QUAD 0.65 0 -0.5231928251 ; }  {Quadr_2}
      { QUAD 1.85 0 0.3797649912 ;  }{Quadr_4}
      { QUAD 1. 0 -0.4141649891 ; } {Quadr_6}
      { QUAD 0.47 0 (0.5148321767+QF) ; } {Quadr_20}
      { QUAD 0.47 0 (-0.5036932361-QD) ; } {Quadr_22}
      SOLENOID 0.7 HZ1 ; {Solen_26}
      { RBEND 1.9395014178063603 0.07853981633970679 0 ; } {RBend_83}
      { SBEND 1.370459105 0.039984488639998664 PI/2 0 0 0 0 0 0 ; } {SBend_10}
      { SBEND 1.370459105 0.039984488639998664 PI/2 0 0 0 0 0 0 ;  }  {SBend_12}
    PM 5315;
  CLOSEF 5315;
  ENDIF;

  WRITE 6 MAP(1) MAP(2) MAP(3) MAP(4) MAP(5) MAP(6);

QUIT 0;

  LATTICE MAPPARAMS MAPARR SPNRARR;

  LOOP I 1 471;
    OPENF 5315 WHERE&'ELEM_'&MRK(I) 'REPLACE';
      RMAPS I MAPARR SPNRARR;
      WRITE 6 'ELEMENT '&MRK(I)&' SYM ERROR = '&ST(SE(MAP));
      PM 5315;
    CLOSEF 5315;
  ENDLOOP;

ENDPROCEDURE;

RUN; END;
