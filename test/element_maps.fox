INCLUDE 'bin/setups/FIRST-ST/SEQFULL';


PROCEDURE RUN;
  VARIABLE RESTMASSAMU 1; VARIABLE GAMMA 1; VARIABLE EKIN 1;
  VARIABLE WHERE 100;
  {LATTICE ARGUMENTS}
  VARIABLE KS 1 2; VARIABLE X  1 2;
  VARIABLE XS 1 4; VARIABLE XM 1 4;
  {for TREL}
  VARIABLE MAPPARAMS 1 12; {HOLDS THE ABOVE VALUES}
  VARIABLE MAPARR 1000 6 542; VARIABLE SPNRARR 1000 3 3 542;
  VARIABLE VRF 1 1 1;
  VARIABLE FREQ 1;
  VARIABLE HNUM 1;

  VARIABLE I 1;

  DIRSET WHERE 'data/ELEMENT_MAPS/FIRST-ST/';
  
  OV 1 3 0;
  SET_FOR_PROTONS 130 X XM XS;
  NAVIGATORS 0 0 1 KS;
  
  MAPPARAMS(1) := X(1);   MAPPARAMS(2) := X(2);   {X}
  MAPPARAMS(3) := XM(1);  MAPPARAMS(4) := XM(2);  {XM}
  MAPPARAMS(5) := XM(3);  MAPPARAMS(6) := XM(4);
  MAPPARAMS(7) := XS(1);  MAPPARAMS(8) := XS(2);  {XS}
  MAPPARAMS(9) := XS(3);  MAPPARAMS(10) := XS(4);
  MAPPARAMS(11):= KS(1);  MAPPARAMS(12) := KS(2); {KS}

 LATTICE MAPPARAMS MAPARR SPNRARR;
  HNUM := 66;
  VRF(1, 1) := 100/HNUM; {RF Voltage [kV]}
  FREQ := HNUM*REVFREQ(ACCLEN(1)); {RF Frequency}
  { UM; RF VRF 0 FREQ 0 0.05; }
  { INSERT 1 MAPARR SPNRARR 614; }

    OPENF 5315 WHERE&'ELEM_RB' 'REPLACE';
      { UM; RBEND 1.9395014178063565 10*0.0785398163399978 0; }
      { FIRST50 KS(1) XS(2) X(1) XS(1); }
      UM; DL 1.841; DL 0.375 ; { DL 1.8125; }
      WRITE 6 ' SYM ERROR = '&ST(SE(MAP));
      PM 5315;
    CLOSEF 5315;

  { LOOP I 42 47; }
  {   OPENF 5315 WHERE&'ELEM_'&MRK(I) 'REPLACE'; }
  {     LMAPS I MAPARR SPNRARR; }
  {     WRITE 6 'ELEMENT '&MRK(I)&' SYM ERROR = '&ST(SE(MAP)); }
  {     PM 5315; }
  {   CLOSEF 5315; }
  { ENDLOOP; }
  
ENDPROCEDURE; {RUN}

RUN; END;
